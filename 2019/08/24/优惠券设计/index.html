<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>优惠券设计 | 学习笔记</title>
  <meta name="author" content="Zhang Yuan">
  
  <meta name="description" content="•    优惠券模块ER图
备注：目前不支持优惠券叠加使用，因此优惠券叠加使用规则表（t_coupon_superposition_limit）暂未使用。
•    优惠券设计
目前平台包含3种类型优惠券：满减券，税费券，运费券。满减券只可抵扣商品价格，税费券只可抵扣商品税费，运费券只可抵扣商品运费">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="优惠券设计"/>
  <meta property="og:site_name" content="学习笔记"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="学习笔记" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">学习笔记</a></h1>
  <h2><a href="/">不积跬步，无以至千里；不积小流，无以成江海。</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">时光轴</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2019-08-24T10:30:20.000Z"><a href="/2019/08/24/优惠券设计/">2019年08月24日</a></time>
      
      
  
    <h1 class="title">优惠券设计</h1>
  

    </header>
    <div class="entry">
      
        <p>•    优惠券模块ER图<br><img src="/.com//图片1.png" alt=""></p>
<p>备注：<br>目前不支持优惠券叠加使用，因此优惠券叠加使用规则表（t_coupon_superposition_limit）暂未使用。</p>
<p>•    优惠券设计</p>
<p>目前平台包含3种类型优惠券：满减券，税费券，运费券。满减券只可抵扣商品价格，税费券只可抵扣商品税费，运费券只可抵扣商品运费。按用途可以分为系统营销券和商品券，二者是互斥的，一个优惠券模版（t_coupon）只能应用到一个地方，如果优惠券模版配置到系统营销（t_coupon_activity_relation），则该券不会在商品详情显示，反之亦然。优惠券模版必须包含领取规则，使用规则以及使用范围。<br>服务端的优惠券管理模块在mgr_yuncang项目实现：<br>1)    优惠券添加与编辑<br>•    优惠券模版添加必须设定领取条件，使用范围，使用条件等信息<br>•    优惠券模版编辑只能修改优惠券数量，且必须大于原始数量<br>•    优惠券模版及规则均创建成功后，按照输入的数量制作全部优惠券，存到优惠券记录表（t_coupon_user_record），制券方法：makingCoupons<br>•    优惠券模版创建成功后，缓存券信息与所有券记录<br>备注：<br>采用优惠券预生成目的是以空间换时间，提升服务器吞吐量，提高用户抢券效率；如单次生成巨量优惠券，这种方式会存在缺陷，可以考虑将总数量拆分多个批次，通过一定策略按批次预生成优惠券；制券任务后续需异步处理<br>2)    系统营销配置<br>•    可根据不同类型的会员，按不同需求配置营销活动增券<br>•    一个系统营销活动可以绑定多张券，且只能选择在商品详情页隐藏的优惠券<br>3)    赠送特定APP用户优惠券<br>•    可向单个或多个用户赠送多种已发布的优惠券，优惠券数量按设定的张数发到用户券包<br>优惠券领取与使用在api_yuncang项目实现：</p>
<ol>
<li>优惠券领取<br>用户可以在四个地方领取优惠券：<br>•    首页弹窗<br>显示系统营销配置的优惠券；用户点击立即领取后，按设定张数全部发放到用户券包<br>•    VIP页<br>和首页弹窗显示优惠券一致，只返回用户未领取的优惠券<br>•    商品详情页<br>可领优惠券为满足使用范围，满足领取条件的商品券<br>•    H5活动页<br>H5页设置固定券码的优惠券，该优惠券由运营人员事先配置好</li>
<li>优惠券查看<br>用户券列表直接读取数据库，未查缓存数据。当缓存中用户券总数与数据库查询数量不一致，清空缓存</li>
<li>优惠券使用<br>用户在结算页可选择单张满足使用条件的优惠券；获取可使用优惠券接口，根据用户当前身份，券使用范围，下单商品价格，税费，运费等信息校验用户有效期内的优惠券是否可使用；</li>
</ol>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/java/">java</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/java/">java</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Blogs/">Blogs</a><small>1</small></li>
  
    <li><a href="/categories/MySQL/">MySQL</a><small>3</small></li>
  
    <li><a href="/categories/Python/">Python</a><small>1</small></li>
  
    <li><a href="/categories/java/">java</a><small>2</small></li>
  
    <li><a href="/categories/linux/">linux</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Java/">Java</a><small>1</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>3</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>1</small></li>
  
    <li><a href="/tags/java/">java</a><small>2</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2019 Zhang Yuan
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
document.write(unescape("%3Cscript src='/js/jquery-2.0.3.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();

// highlight
 hljs.initHighlightingOnLoad();

})(jQuery);
</script>

</body>
</html>
